## ğŸ’¡ê¸‰í•˜ì‹  ë¶„ë“¤ì„ ìœ„í•´ì„œ ê²°ë¡  ë¨¼ì €!

1. **ì˜ì¡´ì  ì¿¼ë¦¬**ëŠ” **ì´ì „ ì¿¼ë¦¬ì˜ ê²°ê³¼ì— ë”°ë¼ ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ëŠ” íŒ¨í„´**ìœ¼ë¡œ, `enabled` ì˜µì…˜ì„ í™œìš©í•´ êµ¬í˜„í•œë‹¤.
2. **ë³‘ë ¬ ì¿¼ë¦¬**ëŠ” **ì—¬ëŸ¬ ë°ì´í„°ë¥¼ ë™ì‹œì— ê°€ì ¸ì™€ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” ê²ƒì´**ë©°,`useQuery`ë¥¼ ë‚˜ì—´í•˜ê±°ë‚˜, `useQueries`ë¡œ êµ¬í˜„í•œë‹¤.
3. **ë°ì´í„° í”„ë¦¬í˜ì¹­**ì€ ì‚¬ìš©ì í–‰ë™ì„ ì˜ˆì¸¡í•´ **ë¯¸ë¦¬ ë°ì´í„°ë¥¼ ë¡œë“œ**í•˜ì—¬ UXë¥¼ ê°œì„ í•˜ëŠ” ê¸°ë²•ì´ë‹¤.
4. ê°ê°ì˜ ê¸°ë²•ì€ ì„œë¡œ ë‹¤ë¥¸ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ì„œ ë‹¤ë¥´ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, `React Query`ì™€`Suspense`ë¥¼ ë™ì‹œì— ê°™ì´ ì“¸ ë•ŒëŠ” ê¸°ì¡´ì˜ ì½”ë“œì™€ ì°¨ì´ì ì„ ìœ ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼ë§Œ í•œë‹¤.

## ë°ì´í„° í˜ì¹­ë¶€í„° UXê¹Œì§€

í˜„ëŒ€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°ì´í„° í˜ì¹­ì€ ë‹¨ìˆœí•œ API í˜¸ì¶œ ê·¸ ì´ìƒì´ë‹¤. ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ í´ë¦­í•˜ê³  í™”ë©´ì´ ì „í™˜ë˜ëŠ” ê·¸ ì§§ì€ ìˆœê°„, ìˆ˜ë§ì€ ë°ì´í„° ìš”ì²­ê³¼ ì‘ë‹µì´ ì˜¤ê³  ê°„ë‹¤. ì´ ê³¼ì •ì„ ìµœì í™”í•˜ëŠ” ê²ƒì€ ë§ˆì¹˜ ë³µì¡í•œ êµí†µ ì²´ê³„ë¥¼ ì„¤ê³„í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ë°ì´í„°ê°€ ì§€ë‚˜ê°€ê²Œë” ì‹ í˜¸ë“±ì€ ì–¸ì œ ì¼œì•¼ í• ê¹Œ? ì–´ë–¤ ì°¨ëŸ‰(í¬í¬ë ˆì¸, SUV, í‚¥ë³´ë“œ) ì´ ë¨¼ì € ì§€ë‚˜ê°€ì•¼ í• ê¹Œ? ìš°ë¦¬ëŠ” ë°ì´í„°ë¼ëŠ” ì°¨ëŸ‰ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¼ëŠ” ë„ë¡œë¥¼ ê°€ì¥ íš¨ìœ¨ì ìœ¼ë¡œ ë‹¬ë¦´ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì°¾ì•„ì•¼ í•œë‹¤. **~~SUV, í¬í¬ë ˆì¸, í‚¥ë³´ë“œ ìˆœìœ¼ë¡œ ë³´ë‚´ë©´ ì¢‹ì„ ê²ƒì´ë‹¤.~~**

> ğŸ‘¨ğŸ»â€ğŸ« : (" ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ë°ì´í„° í˜ì¹­ì˜ ê³ ê¸‰ íŒ¨í„´ì— ëŒ€í•´ í•¨ê»˜ ì•Œì•„ë³¼ ê±°ì˜ˆìš”. ë³µì¡í•œ ìš”êµ¬ì‚¬í•­ì—ë„ ì™„ë²½íˆ ìˆ˜í–‰ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ë°ì´í„° í˜ì¹­ì˜ ìƒí™©ì— ë§ëŠ” ê°ê°ì˜ íŒ¨í„´ì„ ì ìš©í•˜ë©´ ë„ì›€ì´ ë  ê±°ì˜ˆìš”!")
> 

**ë°ì´í„° í˜ì¹­ ìµœì í™”**ëŠ” ë‹¨ìˆœíˆ ì†ë„ë¥¼ ë†’ì´ê¸° ìœ„í•œ ê²ƒ ë¿ë§Œì´ ì•„ë‹ˆë‹¤. **ì•„ë‹ˆ? ë˜ë ¤ ì˜ëª» ì“°ê²Œ ëœë‹¤ë©´, ì†ë„ê°€ ì €í•˜ëœë‹¤.** ì‚¬ìš©ì ê²½í—˜, ì„œë²„ ë¶€í•˜, ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„±, ê·¸ë¦¬ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°˜ì‘ì„±ê¹Œì§€ ëª¨ë‘ ê³ ë ¤í•´ì•¼ í•œë‹¤. ì´ ê¸€ì—ì„œëŠ” **React Queryì—ì„œ** í˜„ëŒ€ì ì¸ ë°ì´í„° í˜ì¹­ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ê³µí†µì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆëŠ” ê³ ê¸‰ íŒ¨í„´ë“¤ì„ ì‚´í´ë³¸ë‹¤.

## 0. ë‹¨ì¼ ì¿¼ë¦¬ ì‘ë™ ë°©ì‹

![](https://velog.velcdn.com/images/kyujenius/post/68221763-1d2c-4a82-8b1a-04b48c505db6/image.png)


### Suspenseì™€ ê°™ì´ ì‚¬ìš©í•  ë•Œì˜ ë‹¨ì¼ ì¿¼ë¦¬ ì‘ë™ ë°©ì‹

![](https://velog.velcdn.com/images/kyujenius/post/3b8e652e-42a0-4821-a8a9-3c132e3ab230/image.png)

## 1. ì˜ì¡´ì  ì¿¼ë¦¬(Dependent Queries) êµ¬í˜„í•˜ê¸°

### ì˜ì¡´ì  ì¿¼ë¦¬ë€?

**ì˜ì¡´ì  ì¿¼ë¦¬**ëŠ” **ì´ì „ ì¿¼ë¦¬ì˜ ê²°ê³¼ì— ë”°ë¼ ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰**í•˜ëŠ” íŒ¨í„´ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì ì •ë³´ë¥¼ ë¨¼ì € ê°€ì ¸ì˜¨ í›„ í•´ë‹¹ ì‚¬ìš©ìì˜ ì£¼ë¬¸ ë‚´ì—­ì„ ê°€ì ¸ì˜¤ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ëŸ° ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì²« ë²ˆì§¸ ì¿¼ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ê³  í•„ìš”í•œ ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ë‘ ë²ˆì§¸ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì•¼ í•œë‹¤.

### ì˜ì¡´ì  ì¿¼ë¦¬ ì‘ë™ ë°©ì‹
![](https://velog.velcdn.com/images/kyujenius/post/a13f532a-c49b-4e8e-8ca4-e4cf8447ca71/image.png)


### React Queryì—ì„œì˜ êµ¬í˜„

React Queryì—ì„œëŠ” `enabled` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì  ì¿¼ë¦¬ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```jsx
*// ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°*
const { data: user } = useQuery(['user', userId], fetchUser);

*// ì‚¬ìš©ì ì •ë³´ê°€ ìˆì„ ë•Œë§Œ ì£¼ë¬¸ ë‚´ì—­ ê°€ì ¸ì˜¤ê¸°*
const { data: orders } = useQuery(
  ['orders', user?.id],
  () => fetchOrders(user.id),
  {
    *// userê°€ ìˆê³  user.idê°€ ì¡´ì¬í•  ë•Œë§Œ ì¿¼ë¦¬ í™œì„±í™”*
    enabled: !!user?.id,
  }
);

*// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/dependent-queries*
```

### ì˜ì¡´ì  ì¿¼ë¦¬ì˜ ì¥ì 

1. **ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€**: ì„ í–‰ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° í›„ì† ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šì•„ ë¦¬ì†ŒìŠ¤ë¥¼ ì ˆì•½í•œë‹¤.
2. **ë°ì´í„° ì¼ê´€ì„± ìœ ì§€**: ì˜ì¡´ ê´€ê³„ê°€ ìˆëŠ” ë°ì´í„°ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ê°€ì ¸ì™€ ì¼ê´€ì„±ì„ ë³´ì¥í•œë‹¤.
3. **ì—ëŸ¬ í•¸ë“¤ë§ ê°„ì†Œí™”**: ì„ í–‰ ì¿¼ë¦¬ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ í›„ì† ì¿¼ë¦¬ëŠ” ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì—ëŸ¬ ì²˜ë¦¬ê°€ ë‹¨ìˆœí•´ì§„ë‹¤.

> "(ğŸ‘¨ğŸ»â€ğŸ« : ì˜ì¡´ì  ì¿¼ë¦¬ëŠ” ë§ˆì¹˜ ë„ë¯¸ë…¸ì™€ ê°™ì•„ìš”! ì²« ë²ˆì§¸ ë„ë¯¸ë…¸ê°€ ì“°ëŸ¬ì ¸ì•¼ ë‹¤ìŒ ë„ë¯¸ë…¸ë„ ì“°ëŸ¬ì§ˆ ìˆ˜ ìˆì£ . ì´ì²˜ëŸ¼ ë°ì´í„° ê°„ì˜ ê´€ê³„ë¥¼ ëª…í™•íˆ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì €ë¼ë©´ ì € `enabled` ì•ˆì— ê°’ì„ ë„£ì„ ë•Œ, ìµœëŒ€í•œ ë‚¨ë“¤ì´ ë´¤ì„ ë•Œ ì§ê´€ì ì¸ ë³€ìˆ˜ë¡œ ì´ë¦„ì„ ì ì–´ì„œ ì“¸ ê±° ê°™ì•„ìš” `!!user?.id` ê°€ ì•„ë‹ˆë¼ `isUserIdExist` ë¡œ ë§ì´ì£  )"
> 

### Suspenseì™€ ê°™ì´ ì‚¬ìš©í•  ë•Œì˜ ì˜ì¡´ì  ì¿¼ë¦¬ ì‘ë™ ë°©ì‹

![](https://velog.velcdn.com/images/kyujenius/post/f13af65b-7558-4f8d-9a1d-58654662a3fd/image.png)


## 2. ë³‘ë ¬ ì¿¼ë¦¬(Parallel Queries)ì™€ ì„±ëŠ¥ ìµœì í™”

### ë³‘ë ¬ ì¿¼ë¦¬ì˜ ê°œë…

**ë³‘ë ¬ ì¿¼ë¦¬**ëŠ” ì—¬ëŸ¬ ë°ì´í„° ìš”ì²­ì„ ë™ì‹œì— ì‹¤í–‰í•˜ì—¬ ì „ì²´ ë¡œë”© ì‹œê°„ì„ ë‹¨ì¶•í•˜ëŠ” ê¸°ë²•ì´ë‹¤. ì„œë¡œ ë…ë¦½ì ì¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ íŠ¹íˆ ìœ ìš©í•˜ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ì—ì„œ ì‚¬ìš©ì ì •ë³´, í†µê³„ ë°ì´í„°, ìµœê·¼ í™œë™ ë“±ì„ ë™ì‹œì— ê°€ì ¸ì™€ì•¼ í•  ë•Œ ë³‘ë ¬ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤.
### ë³‘ë ¬ ì¿¼ë¦¬ ì‘ë™ ë°©ì‹
![](https://velog.velcdn.com/images/kyujenius/post/07deddd5-33b4-4872-9ef0-a2d14e8cd5eb/image.png)


### React Queryì—ì„œì˜ êµ¬í˜„

React Queryì—ì„œëŠ” ì—¬ëŸ¬ `useQuery` í›…ì„ ì‚¬ìš©í•˜ê±°ë‚˜ `useQueries` í›…ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
*// ë°©ë²• 1: ì—¬ëŸ¬ useQuery í›… ì‚¬ìš©*
const usersQuery = useQuery('users', fetchUsers);
const projectsQuery = useQuery('projects', fetchProjects);
const tasksQuery = useQuery('tasks', fetchTasks);

*// ë°©ë²• 2: useQueries í›… ì‚¬ìš©*
const results = useQueries([
  { queryKey: ['users'], queryFn: fetchUsers },
  { queryKey: ['projects'], queryFn: fetchProjects },
  { queryKey: ['tasks'], queryFn: fetchTasks }
]);

*// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/parallel-queries*
```

### ë™ì  ë³‘ë ¬ ì¿¼ë¦¬ ì²˜ë¦¬

ë•Œë¡œëŠ” ë™ì ìœ¼ë¡œ ìƒì„±ëœ ì—¬ëŸ¬ ì¿¼ë¦¬ë¥¼ ë³‘ë ¬ë¡œ ì‹¤í–‰í•´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ëŸ¬ ì‚¬ìš©ì ID ëª©ë¡ì´ ìˆì„ ë•Œ ê° ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë™ì‹œì— ê°€ì ¸ì˜¤ëŠ” ê²½ìš°ê°€ ìˆë‹¤.

```jsx
*// ë™ì ìœ¼ë¡œ ìƒì„±ëœ ì¿¼ë¦¬ë“¤ì„ ë³‘ë ¬ë¡œ ì‹¤í–‰*
const userQueries = useQueries(
  userIds.map(id => {
    return {
      queryKey: ['user', id],
      queryFn: () => fetchUser(id),
    }
  })
);

*// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/parallel-queries*
```

### ë³‘ë ¬ ì¿¼ë¦¬ì˜ ì„±ëŠ¥ ìµœì í™” íŒ

1. **ì ì ˆí•œ ìºì‹± ì „ëµ ì‚¬ìš©**: ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” ìºì‹œ ì‹œê°„ì„ ê¸¸ê²Œ ì„¤ì •í•œë‹¤.
2. **ì¿¼ë¦¬ ìš°ì„ ìˆœìœ„ ì„¤ì •**: React Queryì˜ `priority` ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì¤‘ìš”í•œ ì¿¼ë¦¬ì— ìš°ì„ ìˆœìœ„ë¥¼ ë¶€ì—¬í•œë‹¤.
3. **ë„¤íŠ¸ì›Œí¬ ì›Œí„°í´ ë°©ì§€**: ì˜ì¡´ì„±ì´ ì—†ëŠ” ì¿¼ë¦¬ëŠ” ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ì—¬ ì›Œí„°í´ íš¨ê³¼ë¥¼ ë°©ì§€í•œë‹¤.
4. **ë°ì´í„° í”„ë¦¬í˜ì¹­ í™œìš©**: ì‚¬ìš©ìê°€ í•„ìš”ë¡œ í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ë°ì´í„°ëŠ” ë¯¸ë¦¬ ê°€ì ¸ì˜¨ë‹¤.

```jsx
*// ì¿¼ë¦¬ ìš°ì„ ìˆœìœ„ ì„¤ì • ì˜ˆì‹œ*
const usersQuery = useQuery('users', fetchUsers, { priority: 1 }); *// ë†’ì€ ìš°ì„ ìˆœìœ„*
const logsQuery = useQuery('logs', fetchLogs, { priority: 0 }); *// ë‚®ì€ ìš°ì„ ìˆœìœ„
// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/query-priorities*
```

> "(ğŸ‘¨ğŸ»â€ğŸ« : ë³‘ë ¬ ì¿¼ë¦¬ëŠ” ë§ˆì¹˜ ì—¬ëŸ¬ ëª…ì˜ ì§ì›ì´ ê°ì ë‹¤ë¥¸ ì—…ë¬´ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ê²ƒê³¼ ê°™ì•„ìš”! íš¨ìœ¨ì ì´ì§€ë§Œ, ë„ˆë¬´ ë§ì€ ìš”ì²­ì„ ë™ì‹œì— ë³´ë‚´ë©´ ì„œë²„ì— ë¶€ë‹´ì´ ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì ì ˆí•œ ê· í˜•ì´ í•„ìš”í•©ë‹ˆë‹¤.)"
> 

### Suspenseì™€ ê°™ì´ ì‚¬ìš©í•  ë•Œì˜ ë³‘ë ¬ ì¿¼ë¦¬

`TanStack Query v5`ì—ì„œ `Suspense`ì™€ ë³‘ë ¬ ì¿¼ë¦¬ë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ë•Œì˜ ì ‘ê·¼ ë°©ì‹ì„ ë¶„ì„í•˜ê² ë‹¤.

### Suspenseì™€ TanStack Queryì˜ ë³‘ë ¬ ì²˜ë¦¬ ì´ìŠˆ

**React Suspenseì™€ TanStack Queryë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ ë°œìƒí•˜ëŠ” ì¤‘ìš”í•œ ê³ ë ¤ì‚¬í•­ì´ ìˆë‹¤:**

1. `useQuery`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë³‘ë ¬ë¡œ ì‹¤í–‰ëœë‹¤. 
2. í•˜ì§€ë§Œ, React-Queryì™€ Suspenseë¥¼ ê°™ì´ ì‚¬ìš©í•  ë•Œì—ëŠ” `useSuspenseQuery`ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
3. ì—¬ëŸ¬ ê°œì˜ `useSuspenseQuery`ë¥¼ í•œ ë²ˆì— ì‚¬ìš©í•  ë•Œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤. ê° ì¿¼ë¦¬ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ì›Œí„°í´(waterfall) íš¨ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
4. ê° ì¿¼ë¦¬ê°€ ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì„œ, ë³‘ë ¬ ì²˜ë¦¬ë¥¼ í•´ì£¼ì§€ ì•Šìœ¼ë©´ ê°ê°ì˜ ì¿¼ë¦¬ë“¤ì´ ì•ë‹¨ì˜ ì¿¼ë¦¬ë“¤ì´ ëë‚˜ê¸°ê¹Œì§€ë¥¼ ê¸°ë‹¤ë ¤ì•¼í•œë‹¤.

### ì›Œí„°í´ í˜„ìƒ ì‹œê°í™”
![](https://velog.velcdn.com/images/kyujenius/post/3dda2fcd-23fb-4812-b71f-f497823231f9/image.png)

> "(ğŸ‘¨ğŸ»â€ğŸ« : ë³‘ë ¬ ì²˜ë¦¬ê°€ ì•„ë‹Œ, ë™ê¸°ì  ì²˜ë¦¬ì²˜ëŸ¼ ë³´ì´ì£ ? Fallback UI ë¥¼ ë„ì›Œë‘” ì±„, í•˜ë‚˜ê°€ ëë‚  ë•Œê¹Œì§€ ë‹¤ìŒ ì¿¼ë¦¬ëŠ” ëŒ€ê¸°í•˜ê³  ìˆì–´ì•¼ í•˜ê³ , ê·¸ë ‡ê²Œ ëª¨ë“  ì¿¼ë¦¬ë“¤ì´ ë‹¤ ëë‚˜ê³  ë‚˜ì„œì•¼ ëœë”ë§ì´ ë˜ëŠ” ê²ƒì€ ë³‘ë ¬ ì²˜ë¦¬ë¼ê³  í•  ìˆ˜ ì—†ê² ì£ ? ã…ã…)"
> 

### í•´ê²°ì±…1: useSuspenseQueries

TanStack Query v5ì—ì„œëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `useSuspenseQueries`ë¥¼ ì œê³µí•œë‹¤. ì´ëŠ” Suspense í™˜ê²½ì—ì„œ ì—¬ëŸ¬ ì¿¼ë¦¬ë¥¼ ë³‘ë ¬ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í›…ì´ë‹¤.

```jsx
import { useSuspenseQueries } from '@tanstack/react-query';

*// Suspenseì™€ í•¨ê»˜ ë³‘ë ¬ ì¿¼ë¦¬ ì‹¤í–‰*
const results = useSuspenseQueries({
  queries: [
    { queryKey: ['users'], queryFn: fetchUsers },
    { queryKey: ['projects'], queryFn: fetchProjects },
    { queryKey: ['tasks'], queryFn: fetchTasks }
  ]
});
```

ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´:

- ëª¨ë“  ì¿¼ë¦¬ê°€ ë³‘ë ¬ë¡œ ì‹œì‘ëœë‹¤.
- ëª¨ë“  ì¿¼ë¦¬ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì»´í¬ë„ŒíŠ¸ëŠ” ì¼ì‹œ ì¤‘ë‹¨(suspend)ëœë‹¤.
- ì›Œí„°í´ íš¨ê³¼ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

### í•´ê²°ì±…2: ê°ê°ì˜ ì¿¼ë¦¬ë§ˆë‹¤ Suspense ì‚¬ìš©

ë˜ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œëŠ” ê° ì¿¼ë¦¬ë¥¼ ë³„ë„ì˜ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬í•˜ê³ , ê° ì»´í¬ë„ŒíŠ¸ì— Suspense ê²½ê³„ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì´ë‹¤:

```jsx
function App() {
  return (
    <>
      <Suspense fallback={<div>Loading users...</div>}>
        <UserComponent />
      </Suspense>
      <Suspense fallback={<div>Loading projects...</div>}>
        <ProjectComponent />
      </Suspense>
      <Suspense fallback={<div>Loading tasks...</div>}>
        <TaskComponent />
      </Suspense>
    </>
  );
}
```

ì´ ë°©ì‹ì€ ê° ë°ì´í„° ë¡œë”©ì´ ë…ë¦½ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•  ìˆ˜ ìˆë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ, Suspenseì™€ í•¨ê»˜ ë³‘ë ¬ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `useSuspenseQueries`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì í•©í•œ ë°©ë²•ì´ë‹¤.

## 3. ë°ì´í„° í”„ë¦¬í˜ì¹­ ì „ëµê³¼ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

### í”„ë¦¬í˜ì¹­ì˜ ê°œë…ê³¼ ì¤‘ìš”ì„±

**ë°ì´í„° í”„ë¦¬í˜ì¹­**ì€ ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê¸° ì „ì— ë¯¸ë¦¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê¸°ìˆ ì´ë‹¤. ì´ëŠ” ì‚¬ìš©ìì˜ í–‰ë™ íŒ¨í„´ì„ ì˜ˆì¸¡í•˜ì—¬ í•„ìš”í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œí•¨ìœ¼ë¡œì¨ ì‚¬ìš©ì ê²½í—˜ì„ í¬ê²Œ í–¥ìƒì‹œí‚¨ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ ëª©ë¡ì—ì„œ í•­ëª©ì„ í´ë¦­í•  ê°€ëŠ¥ì„±ì´ ë†’ì„ ë•Œ í•´ë‹¹ í•­ëª©ì˜ ìƒì„¸ ì •ë³´ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

![ì—…ë¡œë“œì¤‘..](blob:https://velog.io/e9a3094b-240c-4d8d-bd20-046d5a0b4e52)


### React Queryì—ì„œì˜ í”„ë¦¬í˜ì¹­ êµ¬í˜„

React Queryì—ì„œëŠ” `queryClient.prefetchQuery` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

```jsx
*// ì‚¬ìš©ìê°€ ëª©ë¡ í•­ëª©ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ìƒì„¸ ì •ë³´ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°*
const queryClient = useQueryClient();

const handleMouseEnter = (itemId) => {
  queryClient.prefetchQuery(
    ['item', itemId],
    () => fetchItemDetails(itemId),
    { staleTime: 30000 } *// 30ì´ˆ ë™ì•ˆ ë°ì´í„°ë¥¼ ì‹ ì„ í•œ ìƒíƒœë¡œ ìœ ì§€*
  );
};

*// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/prefetching*
```

### í”„ë¦¬í˜ì¹­ ì „ëµ

1. **í˜¸ë²„ ê¸°ë°˜ í”„ë¦¬í˜ì¹­**: ì‚¬ìš©ìê°€ ìš”ì†Œ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ê´€ë ¨ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¨ë‹¤.
2. **í˜ì´ì§€ ì „í™˜ ê¸°ë°˜ í”„ë¦¬í˜ì¹­**: ì‚¬ìš©ìê°€ ë§í¬ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•˜ê¸° ì „ì— ë‹¤ìŒ í˜ì´ì§€ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œí•œë‹¤.
3. **ìŠ¤í¬ë¡¤ ê¸°ë°˜ í”„ë¦¬í˜ì¹­**: ì‚¬ìš©ìê°€ ëª©ë¡ì˜ ëì— ê°€ê¹Œì›Œì§ˆ ë•Œ ë‹¤ìŒ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¨ë‹¤.
4. **ì‹œê°„ ê¸°ë°˜ í”„ë¦¬í˜ì¹­**: íŠ¹ì • ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ê°±ì‹ í•œë‹¤.

### ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì„ ìœ„í•œ í”„ë¦¬í˜ì¹­ êµ¬í˜„ ì˜ˆì‹œ

```jsx
*// í˜ì´ì§€ ì „í™˜ ê¸°ë°˜ í”„ë¦¬í˜ì¹­ ì˜ˆì‹œ*
import { Link } from 'react-router-dom';
import { useQueryClient } from 'react-query';

function ProductList({ products }) {
  const queryClient = useQueryClient();
  
  return (
    <ul>
      {products.map(product => (
        <li 
          key={product.id}
          onMouseEnter={() => {
            *// ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ìƒì„¸ ì •ë³´ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°*
            queryClient.prefetchQuery(
              ['product', product.id],
              () => fetchProductDetails(product.id)
            );
          }}
        >
          <Link to={`/product/${product.id}`}>
            {product.name}
          </Link>
        </li>
      ))}
    </ul>
  );
}

*// ì¶œì²˜: https://tanstack.com/query/latest/docs/react/guides/prefetching*
```

### í”„ë¦¬í˜ì¹­ ì‹œ ê³ ë ¤ì‚¬í•­

1. **ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**: ë„ˆë¬´ ë§ì€ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ë©´ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ê³¼ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•  ìˆ˜ ìˆë‹¤.
2. **ìºì‹œ ê´€ë¦¬**: í”„ë¦¬í˜ì¹˜ëœ ë°ì´í„°ì˜ ì ì ˆí•œ ìºì‹œ ìœ íš¨ ê¸°ê°„ì„ ì„¤ì •í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ ì‚¬ìš©ì„ ë°©ì§€í•œë‹¤.
3. **ì‚¬ìš©ì í–‰ë™ ì˜ˆì¸¡**: ì‚¬ìš©ìì˜ ì‹¤ì œ í–‰ë™ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ í”„ë¦¬í˜ì¹­ ì „ëµì„ ìµœì í™”í•œë‹¤.
4. **ì˜¤í”„ë¼ì¸ ì§€ì›**: í”„ë¦¬í˜ì¹˜ëœ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œë„ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.

> "(ğŸ‘¨ğŸ»â€ğŸ« : í”„ë¦¬í˜ì¹­ì€ ë§ˆì¹˜ ì‹ë‹¹ì—ì„œ ì†ë‹˜ì´ ì£¼ë¬¸í•˜ê¸° ì „ì— ì¸ê¸° ë©”ë‰´ë¥¼ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘ëŠ” ê²ƒê³¼ ê°™ì•„ìš”! ì†ë‹˜ì´ ì˜¤ìë§ˆì ë°”ë¡œ ìŒì‹ì„ ì œê³µí•  ìˆ˜ ìˆì£ . í•˜ì§€ë§Œ ë„ˆë¬´ ë§ì€ ìŒì‹ì„ ë¯¸ë¦¬ ì¤€ë¹„í•˜ë©´ ë‚­ë¹„ê°€ ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì ì ˆí•œ ì˜ˆì¸¡ë° ìµœì í™”ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.)"
> 

ì•ìœ¼ë¡œì˜ ì›¹ ê°œë°œì—ì„œëŠ” ë°ì´í„°ì™€ UIì˜ ê²½ê³„ê°€ ë”ìš± ëª¨í˜¸í•´ì§€ê³ , ë°ì´í„° í˜ì¹­ì´ ë”ìš± ì„ ì–¸ì ì´ê³  ìë™í™”ë  ê²ƒì´ë‹¤. â€˜ì„ ì–¸ì ì´ë‹¤â€™ ë¼ëŠ” ë§ì€ ì ì°¨ `â€˜ë¬´ì—‡â€™ì„ í• ì§€`ì— ì´ˆì ì„ ë‘ê³ , `â€˜ì–´ë–»ê²Œâ€™ ì‘ë™ë˜ëŠ”ì§€`ì— ëŒ€í•´ì„œëŠ” ì¶”ìƒí™”ê°€ ë˜ë‹ˆ ë”ë”ìš± ì§ì ‘ ì•Œì•„ë³´ê³  ì œëŒ€ë¡œ ì¨ì•¼í•œë‹¤ëŠ” ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ë¬´ì‘ì • ì¢‹ì€ ê¸°ìˆ ì´ë¼ê³  ë§ˆêµ¬ì¡ì´ë¡œ ì¼ë‹¤ê°€ëŠ”, ì˜¤íˆë ¤ ë…ì´ ë  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ë³€í™”ì— ë’¤ì³ì§€ì§€ ì•Šìœ¼ë ¤ë©´, ê³„ì†í•´ì„œ ì§€ì†ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ì‹¤í—˜í•˜ëŠ” ìì„¸ê°€ ì¤‘ìš”í•˜ë‹¤. 

> ğŸ™‡ğŸ»Â ê¸€ ë‚´ì— í‹€ë¦° ì , ì˜¤íƒˆì, ë¹„íŒ, ê³µê° ë“± ëª¨ë‘ ì ì–´ì£¼ì…”ë„ ë©ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤..!Â ğŸ™‡ğŸ»
