## React Nativeì˜ í•œê³„: CommonJS ëª¨ë“ˆ ì‹œìŠ¤í…œê³¼ì˜ ì”¨ë¦„

"ì´ê²Œ ì™œ ì•ˆ ë˜ì§€?" ë¼ëŠ” ë§ì„ í•˜ë£¨ì—ë„ ìˆ˜ì‹­ ë²ˆ ì¤‘ì–¼ê±°ë¦¬ë©° í„°ë¯¸ë„ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë…¸ë ¤ë³´ê³  ìžˆë‹¤ë©´, ë‹¹ì‹ ì€ ì•„ë§ˆë„ React Nativeì™€ ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœê³„ ì‚¬ì´ì˜ ê°„ê·¹ê³¼ ì‹¸ìš°ê³  ìžˆì„ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. (~~ê·¸ê²Œ ë‚˜ë‹¤.. ã…Ž_ã…Ž~~) íŠ¹ížˆ ê·¸ ì¤‘ì‹¬ì—ëŠ” CommonJSë¼ëŠ”, ë§ˆì¹˜ ê³ ëŒ€ ìœ ë¬¼ì²˜ëŸ¼ React Nativeê°€ ê³ ìˆ˜í•˜ê³  ìžˆëŠ” ëª¨ë“ˆ ì‹œìŠ¤í…œì´ ìžˆë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : ì²˜ìŒì—ëŠ” CommonJS ëŠ” JS ì˜ ëŒ€ëª…ì‚¬ ê°™ì€ ëŠë‚Œì¸ ì¤„ ì•Œì•˜ê³ , ESMì€ ì¡°ê¸ˆ ìµœì‹  JS ê² êµ¬ë‚˜~ ì‹¶ì—ˆìŠµë‹ˆë‹¤. í•˜í•˜, ì–¼ë§ˆë‚˜ ìˆœì§„í–ˆë˜ê°€ìš”... ì•ˆë‹¤ê³  í¬ê²Œ ë‚˜ì•„ì§ˆê¹Œ ì‹¶ìœ¼ë©´ì„œë„... ê·¸ëž˜ë„ ì™œ ë§žëŠ”ì§€ëŠ” ì•Œê³  ë§žëŠ” ê²Œ ì¢‹ì§€ ì•Šì„ê¹Œ ì‹¶ì–´ì„œ ìž˜ ì •ë¦¬í•´ë´¤ìŠµë‹ˆë‹¤.)
> 

ì˜¤ëŠ˜ì€ React Nativeê°€ ì—¬ì „ížˆ CommonJSì— ì˜ì¡´í•˜ë©´ì„œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œì ê³¼ ê·¸ í•´ê²° ë°©ë²•ì— ëŒ€í•´ ê¹Šì´ ìžˆê²Œ ì‚´íŽ´ë³´ë ¤ í•œë‹¤. ì´ ê¸€ì„ í†µí•´ ë‹¹ì‹ ì´ ê²ªê³  ìžˆëŠ” ë§Žì€ "ì´ìƒí•œ" ì˜¤ë¥˜ë“¤ì˜ ê·¼ë³¸ ì›ì¸ì„ ì´í•´í•˜ê³ , ë” íš¨ìœ¨ì ì¸ í•´ê²°ì±…ì„ ì°¾ëŠ” ë° ë„ì›€ì´ ë˜ê¸¸ ë°”ëž€ë‹¤.

## ðŸ’¡ê¸‰í•˜ì‹  ë¶„ë“¤ì„ ìœ„í•´ì„œ ê²°ë¡  ë¨¼ì €!

1. `React Native`ëŠ” ì—¬ì „ížˆ `CommonJS` ëª¨ë“ˆ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ë©°, ì´ëŠ” ìµœì‹  ESM ê¸°ë°˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í˜¸í™˜ì„± ë¬¸ì œë¥¼ ì¼ìœ¼í‚¨ë‹¤.
2. `Metro` ë²ˆë“¤ëŸ¬ì˜ ì œí•œëœ ê¸°ëŠ¥ì€ ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœê³„ì™€ì˜ í†µí•©ì„ ì–´ë µê²Œ ë§Œë“ ë‹¤.
3. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œëŠ” `babel-plugin-transform-modules`, `metro-react-native-babel-preset` ì»¤ìŠ¤í„°ë§ˆì´ì§•, ë˜ëŠ” `ESM` ì§€ì› ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì´ ìžˆë‹¤.
4. `React Native`ì˜ ì•„í‚¤í…ì²˜ ë³€í™”ì™€ í•¨ê»˜ `Hermes` ì—”ì§„ì˜ ë°œì „ìœ¼ë¡œ ì ì§„ì ì¸ ê°œì„ ì´ ì´ë£¨ì–´ì§€ê³  ìžˆë‹¤.
5. ê°œë°œìžëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ ì‹œ `CommonJS` í˜¸í™˜ì„±ì„ í™•ì¸í•˜ê³ , í•„ìš”í•œ ê²½ìš° ë³€í™˜ ë„êµ¬ë¥¼ í™œìš©í•´ì•¼ í•œë‹¤.

## CommonJSì™€ ESM: ë‘ ì„¸ê³„ì˜ ì¶©ëŒ

ìžë°”ìŠ¤í¬ë¦½íŠ¸ ëª¨ë“ˆ ì‹œìŠ¤í…œì˜ ì—­ì‚¬ëŠ” ë³µìž¡í•˜ë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ `ëª¨ë“ˆ ì‹œìŠ¤í…œ`ì´ ì—†ë˜ ì‹œì ˆ, `Node.js`ëŠ” `CommonJS`ë¼ëŠ” ëª¨ë“ˆ ì‹œìŠ¤í…œì„ ë„ìž…í–ˆë‹¤. ì´ ì‹œìŠ¤í…œì€ `require()`ì™€ `module.exports`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê³  ë‚´ë³´ë‚´ëŠ” ë°©ì‹ì´ë‹¤.

```jsx
*// CommonJS ë°©ì‹*
const React = require('react');
module.exports = MyComponent;

```

ë°˜ë©´, ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” `ECMAScript Modules(ESM)`ì´ë¼ëŠ” í‘œì¤€ ëª¨ë“ˆ ì‹œìŠ¤í…œì„ ì±„íƒí–ˆìœ¼ë©°, ì´ëŠ” `import`ì™€ `export` êµ¬ë¬¸ì„ ì‚¬ìš©í•œë‹¤.

```jsx
*// ESM ë°©ì‹*
import React from 'react';
export default MyComponent;

```

## CommonJSê°€ ì“°ì´ëŠ” ê²½ìš° vs ESMì´ ì“°ì´ëŠ” ê²½ìš°

`CommonJS`ì™€ `ESM`ì€ ê°ê° ë‹¤ë¥¸ í™˜ê²½ê³¼ ìš”êµ¬ì‚¬í•­ì— ë§žê²Œ ì‚¬ìš©ëœë‹¤.

### CommonJSê°€ ì“°ì´ëŠ” ê²½ìš°

`CommonJS`ëŠ” ì£¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì‚¬ìš©ëœë‹¤:

- **ì„œë²„ ì‚¬ì´ë“œ Node.js ê°œë°œ**: Node.jsì˜ ì´ˆê¸°ë¶€í„° ì‚¬ìš©ëœ ëª¨ë“ˆ ì‹œìŠ¤í…œìœ¼ë¡œ, ì„œë²„ ê°œë°œì— ìµœì í™”ë˜ì–´ ìžˆë‹¤.
- **ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ë‚˜ ë²ˆë“¤ë§ì´ í•„ìš” ì—†ëŠ” ì•±**: ê°„ë‹¨í•œ êµ¬ì¡°ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©í•˜ë‹¤.
- **í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í”„ë ˆìž„ì›Œí¬ë¥¼ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì•±**: ë³µìž¡í•œ ì˜ì¡´ì„± ê´€ë¦¬ê°€ í•„ìš” ì—†ëŠ” ê²½ìš°ì— ì í•©í•˜ë‹¤.
- **ëª…ë ¹ì¤„ ë„êµ¬ì™€ ìœ í‹¸ë¦¬í‹°**: ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ ìž‘ì„±ì— ì í•©í•˜ë‹¤.
- **API ì„œë²„ì™€ ë°±ì—”ë“œ ì„œë¹„ìŠ¤**: ì„œë²„ í™˜ê²½ì—ì„œì˜ ì•ˆì •ì„±ì´ ì¤‘ìš”í•œ ê²½ìš°ì— ì‚¬ìš©ëœë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : ì €ëŠ” ì£¼ë¡œ ì˜¤ëž˜ëœ Node.js í”„ë¡œì íŠ¸ë‚˜ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•  ë•Œ CommonJSë¥¼ ì‚¬ìš©í•œë‹µë‹ˆë‹¤. ìµìˆ™í•˜ê³  ì•ˆì •ì ì´ë‹ˆê¹Œìš”!)
> 

### ESMì´ ì“°ì´ëŠ” ê²½ìš°

ESMì€ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì£¼ë¡œ ì‚¬ìš©ëœë‹¤:

- **ìµœì‹  ë¸Œë¼ìš°ì € í™˜ê²½ì˜ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ê°œë°œ**: ë¸Œë¼ìš°ì €ì—ì„œ ë„¤ì´í‹°ë¸Œ ì§€ì›ì„ ë°›ëŠ”ë‹¤.
- **í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í”„ë ˆìž„ì›Œí¬ë¥¼ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ì•±**: React, Vue.js, Angular ë“±ì˜ ìµœì‹  í”„ë ˆìž„ì›Œí¬ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ê¸° ì í•©í•˜ë‹¤.
- **ë™ì  ìž„í¬íŠ¸ê°€ í•„ìš”í•œ ì•±**: ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ê³¼ ì§€ì—° ë¡œë”©ì„ í™œìš©í•  ìˆ˜ ìžˆë‹¤.
- **ë‹¨ì¼ íŽ˜ì´ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜(SPA)**: ëª¨ë“ˆí™”ëœ êµ¬ì¡°ì™€ ë¹„ë™ê¸° ë¡œë”©ì´ ì¤‘ìš”í•œ ê²½ìš°ì— ì í•©í•˜ë‹¤.
- **í”„ë¡œê·¸ë ˆì‹œë¸Œ ì›¹ ì•±(PWA)**: ìµœì‹  ì›¹ ê¸°ìˆ ì„ í™œìš©í•˜ëŠ” ì•±ì— ì í•©í•˜ë‹¤.
- **ìƒˆë¡œìš´ í”„ë¡œì íŠ¸**: ë¯¸ëž˜ í˜¸í™˜ì„±ì„ ê³ ë ¤í•  ë•Œ ESMì´ ê¶Œìž¥ëœë‹¤.

### CommonJSì™€ ESMì˜ ì°¨ì´ì : ë²„ì „ì— ë”°ë¥¸ ì„ í˜•ì ì¸ ê²ƒì¸ê°€, ì™„ì „ížˆ ë‹¤ë¥¸ ê²ƒì¸ê°€?

`CommonJS`ì™€ `ESM`ì€ **`ì™„ì „ížˆ ë‹¤ë¥¸ ëª¨ë“ˆ ì‹œìŠ¤í…œ`**ì´ë‹¤. ë‹¨ìˆœížˆ ë²„ì „ì´ ì—…ê·¸ë ˆì´ë“œëœ ê´€ê³„ê°€ ì•„ë‹ˆë¼, ì„¤ê³„ ì² í•™ê³¼ ìž‘ë™ ë°©ì‹ì´ ê·¼ë³¸ì ìœ¼ë¡œ ë‹¤ë¥´ë‹¤.

### ê·¼ë³¸ì ì¸ ì°¨ì´ì 

1. **ë¡œë”© ë°©ì‹**: `CommonJS`ëŠ” `ë™ê¸°ì (synchronous)`ìœ¼ë¡œ ëª¨ë“ˆì„ ë¡œë“œí•˜ëŠ” ë°˜ë©´, `ESM`ì€ `ë¹„ë™ê¸°ì (asynchronous)`ìœ¼ë¡œ ë¡œë“œí•œë‹¤. ì´ëŠ” ì‹¤í–‰ í™˜ê²½ê³¼ ì„±ëŠ¥ì— í° ì˜í–¥ì„ ë¯¸ì¹œë‹¤.
2. **êµ¬ë¬¸ ì°¨ì´**: `CommonJS`ëŠ” `require()`ì™€ `module.exports`ë¥¼ ì‚¬ìš©í•˜ê³ , ESMì€ `import`ì™€ `export` êµ¬ë¬¸ì„ ì‚¬ìš©í•œë‹¤.
3. **ì •ì  ë¶„ì„ ê°€ëŠ¥ì„±**: `ESM`ì€ ì •ì  êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìžˆì–´ ë¹Œë“œ íƒ€ìž„ì— ëª¨ë“ˆ ê°„ì˜ ì˜ì¡´ ê´€ê³„ë¥¼ íŒŒì•…í•  ìˆ˜ ìžˆë‹¤. ë°˜ë©´ `CommonJS`ëŠ” ëŸ°íƒ€ìž„ì—ì„œë§Œ ëª¨ë“ˆ ê´€ê³„ë¥¼ íŒŒì•…í•  ìˆ˜ ìžˆë‹¤.

```jsx
*// CommonJS - ë™ì  ë¡œë”© ê°€ëŠ¥*
const moduleName = 'math';
const math = require(`./utils/${moduleName}`);

*// ESM - ì •ì  ê²½ë¡œë§Œ ê°€ëŠ¥*
import math from './utils/math.js'; *// ë™ì  ê²½ë¡œ ë¶ˆê°€ëŠ¥*

```

1. **íŠ¸ë¦¬ ì‰ì´í‚¹**: ESMì€ ì •ì  ë¶„ì„ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— íŠ¸ë¦¬ ì‰ì´í‚¹ì„ í†µí•´(ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ì œê±°)ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, CommonJSëŠ” ê·¸ë ‡ì§€ ì•Šë‹¤. (ë™ì ìœ¼ë¡œ ìž‘ìš©í•˜ê¸°ì—)
2. **ë¸Œë¼ìš°ì € ì§€ì›**: ESMì€ ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œ ë„¤ì´í‹°ë¸Œë¡œ ì§€ì›ë˜ì§€ë§Œ, CommonJSëŠ” ë²ˆë“¤ëŸ¬ë¥¼ í†µí•´ ë³€í™˜í•´ì•¼ í•œë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : ë‘ ì‹œìŠ¤í…œì€ ë§ˆì¹˜ ìžë™ì°¨ì™€ ë¹„í–‰ê¸°ì˜ ì°¨ì´ì™€ ê°™ë‹µë‹ˆë‹¤. ë‘˜ ë‹¤ ì´ë™ ìˆ˜ë‹¨ì´ì§€ë§Œ, ìž‘ë™ ì›ë¦¬ì™€ ì‚¬ìš© í™˜ê²½ì´ ì™„ì „ížˆ ë‹¤ë¥´ì£ !)
> 

## í˜¸í™˜ì„±ê³¼ ì „í™˜

ë‘ ì‹œìŠ¤í…œì€ ì™„ì „ížˆ ë‹¤ë¥´ì§€ë§Œ, Node.jsì—ì„œëŠ” ë‘ ì‹œìŠ¤í…œ ê°„ì˜ ìƒí˜¸ ìš´ìš©ì„±ì„ ìœ„í•œ ë°©ë²•ì„ ì œê³µí•œë‹¤:

- ESMì—ì„œ CommonJS ëª¨ë“ˆ ì‚¬ìš©: ì¼ë°˜ì ì¸ `import` êµ¬ë¬¸ìœ¼ë¡œ ê°€ëŠ¥í•˜ë‹¤.
- CommonJSì—ì„œ ESM ëª¨ë“ˆ ì‚¬ìš©: ë™ì  `import()` í•¨ìˆ˜ë¥¼ í†µí•´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ê°€ëŠ¥í•˜ë‹¤.

```jsx
*// ESMì—ì„œ CommonJS ëª¨ë“ˆ ì‚¬ìš©*
import add from './add.cjs';

*// CommonJSì—ì„œ ESM ëª¨ë“ˆ ì‚¬ìš©*
(async function() {
  const add = (await import('./index.mjs')).default;
  add(1, 2);
})();

```

Node.js 23ë¶€í„°ëŠ” íŠ¹ì • ì¡°ê±´ í•˜ì—ì„œ `require()`ë¥¼ í†µí•´ ESM ëª¨ë“ˆì„ ë¡œë“œí•  ìˆ˜ ìžˆê²Œ ë˜ì—ˆì§€ë§Œ, ì´ëŠ” ì‹¤í—˜ì  ê¸°ëŠ¥ì´ë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ, CommonJSì™€ ESMì€ ë‹¨ìˆœí•œ ë²„ì „ ì°¨ì´ê°€ ì•„ë‹Œ ì™„ì „ížˆ ë‹¤ë¥¸ ëª¨ë“ˆ ì‹œìŠ¤í…œì´ë©°, ê°ê°ì˜ ìž¥ë‹¨ì ê³¼ ì‚¬ìš© ì‚¬ë¡€ê°€ ìžˆë‹¤. í˜„ìž¬ ìžë°”ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœê³„ëŠ” ESMìœ¼ë¡œ ì ì§„ì ìœ¼ë¡œ ì´ë™í•˜ê³  ìžˆì§€ë§Œ, CommonJSëŠ” ì—¬ì „ížˆ ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìžˆìœ¼ë©° ì•žìœ¼ë¡œë„ ìƒë‹¹ ê¸°ê°„ ì§€ì›ë  ê²ƒì´ë‹¤.

## React Nativeì˜ ì„ íƒ

React NativeëŠ” Metroë¼ëŠ” ìžì²´ ë²ˆë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ë©°, ì´ MetroëŠ” **ì—¬ì „ížˆ CommonJSë¥¼ ê¸°ë³¸ ëª¨ë“ˆ ì‹œìŠ¤í…œìœ¼ë¡œ ì‚¬ìš©**í•œë‹¤. ì´ëŠ” React Nativeê°€ 2015ë…„ì— ì¶œì‹œë˜ì—ˆì„ ë•Œ ESMì´ ì•„ì§ ë„ë¦¬ ì±„íƒë˜ì§€ ì•Šì•˜ë˜ ì‹œê¸°ì  ë°°ê²½ì´ ìžˆë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : ë§ˆì¹˜ ì˜¤ëž˜ëœ ì§‘ì— ì‚´ë©´ì„œ ì „ê¸° ë°°ì„ ì„ ì™„ì „ížˆ êµì²´í•˜ê¸° ì–´ë ¤ìš´ ê²ƒì²˜ëŸ¼, React Nativeë„ ê¸°ë°˜ êµ¬ì¡°ë¥¼ í•œë²ˆì— ë°”ê¾¸ê¸° ì–´ë µë‹µë‹ˆë‹¤!)
> 

### Metro ë²ˆë“¤ëŸ¬ì˜ ì œí•œì‚¬í•­

React Nativeì˜ ë²ˆë“¤ë§ ì‹œìŠ¤í…œì¸ MetroëŠ” ì›¹ ìƒíƒœê³„ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” Webpack, Vite, Rollup ë“±ê³¼ ë¹„êµí–ˆì„ ë•Œ ëª‡ ê°€ì§€ ì¤‘ìš”í•œ ì œí•œì‚¬í•­ì„ ê°€ì§€ê³  ìžˆë‹¤.

### ì œí•œëœ ESM ì§€ì›

MetroëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ESM êµ¬ë¬¸ì„ ì§€ì›í•˜ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œëŠ” ì´ë¥¼ CommonJSë¡œ ë³€í™˜í•˜ì—¬ ì²˜ë¦¬í•œë‹¤. ì´ ê³¼ì •ì—ì„œ ESMì˜ ì¼ë¶€ ê³ ê¸‰ ê¸°ëŠ¥ë“¤ì´ ì œëŒ€ë¡œ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìžˆë‹¤.

```jsx
*// ì´ëŸ° ë™ì  importëŠ” Metroì—ì„œ ë¬¸ì œê°€ ë  ìˆ˜ ìžˆë‹¤*
const module = await import(`./locales/${language}.js`);

```

### ì¡°ê±´ë¶€ ë‚´ë³´ë‚´ê¸° ë¯¸ì§€ì›

ìµœì‹  Node.jsì™€ ì›¹ ìƒíƒœê³„ì—ì„œëŠ” package.jsonì—ì„œ "exports" í•„ë“œë¥¼ í†µí•´ ì¡°ê±´ë¶€ ë‚´ë³´ë‚´ê¸°ë¥¼ ì§€ì›í•œë‹¤. ì´ë¥¼ í†µí•´ ë™ì¼í•œ íŒ¨í‚¤ì§€ê°€ í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¸ ë²„ì „ì˜ ì½”ë“œë¥¼ ì œê³µí•  ìˆ˜ ìžˆë‹¤.

```json
*// package.json*
{
  "exports": {
    "import": "./esm/index.js",
    "require": "./cjs/index.js",
    "react-native": "./native/index.js"
  }
}

```

í•˜ì§€ë§Œ MetroëŠ” ì´ëŸ¬í•œ ì¡°ê±´ë¶€ ë‚´ë³´ë‚´ê¸°ë¥¼ ì™„ì „ížˆ ì§€ì›í•˜ì§€ ì•Šì•„, ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

ì¶œì²˜: [Metro ê³µì‹ ë¬¸ì„œ](https://facebook.github.io/metro/)

## ì‹¤ì œ ê°œë°œ ê³¼ì •ì—ì„œ ë§ˆì£¼ì¹˜ëŠ” ë¬¸ì œë“¤

CommonJS ê¸°ë°˜ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ë©´ì„œ ë°œìƒí•˜ëŠ” ì‹¤ì œ ë¬¸ì œë“¤ì„ ì‚´íŽ´ë³´ìž.

### ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸í™˜ì„± ë¬¸ì œ

ë§Žì€ ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ESMë§Œ ì§€ì›í•˜ê±°ë‚˜ ESMì„ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ë©´ì„œ, React Native í”„ë¡œì íŠ¸ì— í†µí•©í•˜ê¸° ì–´ë ¤ì›Œì¡Œë‹¤.

```bash
Error: Unable to resolve module 'modern-esm-only-library' from 'App.js'

```

ì´ëŸ° ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” React Native ê°œë°œìžì—ê²Œ ë„ˆë¬´ë‚˜ ì¹œìˆ™í•˜ë‹¤. ðŸ¥²

### í…ŒìŠ¤íŠ¸ ë„êµ¬ í†µí•©ì˜ ì–´ë ¤ì›€

Vitestì™€ ê°™ì€ ìµœì‹  í…ŒìŠ¤íŠ¸ ë„êµ¬ë“¤ì€ ESMì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ë©°, React Native í”„ë¡œì íŠ¸ì— í†µí•©í•˜ë ¤ë©´ ì¶”ê°€ì ì¸ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤.

```jsx
*// vitest.config.js*
export default {
  test: {
    deps: {
      inline: ["react-native"]
    }
  }
}

```

í•˜ì§€ë§Œ ì´ëŸ° ë°©ì‹ìœ¼ë¡œë„ ì™„ë²½í•œ í˜¸í™˜ì„±ì„ ë³´ìž¥í•˜ê¸° ì–´ë µë‹¤.

### íƒ€ìž…ìŠ¤í¬ë¦½íŠ¸ ì„¤ì • ë³µìž¡ì„±

íƒ€ìž…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œë„ ëª¨ë“ˆ ì‹œìŠ¤í…œ ê°„ì˜ ì°¨ì´ë¡œ ì¸í•œ ë³µìž¡ì„±ì´ ì¦ê°€í•œë‹¤.

```json
*// tsconfig.json*
{
  "compilerOptions": {
    "module": "ESNext",
    "moduleResolution": "node",
    "esModuleInterop": true
  }
}

```

ì´ëŸ¬í•œ ì„¤ì •ì€ íƒ€ìž…ìŠ¤í¬ë¦½íŠ¸ ì»´íŒŒì¼ëŸ¬ê°€ ESM êµ¬ë¬¸ì„ ì´í•´í•˜ë„ë¡ í•˜ì§€ë§Œ, ì‹¤í–‰ ì‹œì—ëŠ” ì—¬ì „ížˆ Metroê°€ CommonJSë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.

## í•´ê²° ë°©ë²•ê³¼ ëŒ€ì•ˆ

React Nativeì—ì„œ CommonJSì™€ ê´€ë ¨ëœ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ëª‡ ê°€ì§€ ë°©ë²•ì„ ì‚´íŽ´ë³´ìž.

### Babel í”ŒëŸ¬ê·¸ì¸ í™œìš©

`babel-plugin-transform-modules` ê°™ì€ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ESM ì „ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ CommonJSë¡œ ë³€í™˜í•  ìˆ˜ ìžˆë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ«Â : íŠ¹ì • ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼í•  ë•Œ, í•­ìƒ ì„¤ì¹˜ì—ì„œ ëë‚˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ì¶”ê°€ì ì¸ ìž‘ì—…ì„ í•´ì•¼í•˜ëŠ” ì´ìœ ê°€ ì´ëŸ° ì´ìœ ì˜€ë˜ ê²ƒì´ë‹¤..!)
> 

```jsx
*// babel.config.js*
module.exports = {
  plugins: [
    ['babel-plugin-transform-modules', {
      'modern-esm-library': {
        transform: 'modern-esm-library/dist/cjs/index.js',
      },
    }],
  ],
};

```

ì¶œì²˜: [babel-plugin-transform-modules](https://www.npmjs.com/package/babel-plugin-transform-modules)

### Metro ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•

Metro ì„¤ì •ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ íŠ¹ì • íŒ¨í‚¤ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ë³€ê²½í•  ìˆ˜ ìžˆë‹¤.

```jsx
*// metro.config.js*
module.exports = {
  resolver: {
    extraNodeModules: {
      'esm-only-package': require.resolve('./path-to-commonjs-version')
    }
  }
};

```

ì¶œì²˜: [Metro ì„¤ì • ë¬¸ì„œ](https://facebook.github.io/metro/docs/configuration)

### CommonJS í˜¸í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ

ê°€ëŠ¥í•˜ë‹¤ë©´, CommonJSë¥¼ ì§€ì›í•˜ëŠ” ëŒ€ì²´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì´ë‹¤. npm íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê¸° ì „ì— í•´ë‹¹ íŒ¨í‚¤ì§€ê°€ CommonJSë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸í•˜ìž.

```jsx
*# package.jsonì„ í™•ì¸í•˜ì—¬ "type": "module"ì´ ì—†ëŠ”ì§€ í™•ì¸*
npm view some-package

```

## React Nativeì˜ ë¯¸ëž˜ì™€ ESM

React Native íŒ€ë„ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ì¸ì‹í•˜ê³  ìžˆìœ¼ë©°, ìž¥ê¸°ì ìœ¼ë¡œëŠ” ESM ì§€ì›ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ë…¸ë ¥ì„ ê¸°ìš¸ì´ê³  ìžˆë‹¤.

### ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜

React Nativeì˜ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ì¸ "New Architecture"ëŠ” ë‚´ë¶€ êµ¬ì¡°ë¥¼ í˜„ëŒ€í™”í•˜ëŠ” ê³¼ì •ì˜ ì¼ë¶€ì´ë©°, ì´ëŠ” ìž¥ê¸°ì ìœ¼ë¡œ ëª¨ë“ˆ ì‹œìŠ¤í…œ ê°œì„ ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìžˆë‹¤.

### Hermes ì—”ì§„ì˜ ë°œì „

React Nativeì˜ ìžë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì¸ Hermesë„ ì§€ì†ì ìœ¼ë¡œ ë°œì „í•˜ê³  ìžˆìœ¼ë©°, ESM ì§€ì›ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ìž‘ì—…ì´ ì§„í–‰ ì¤‘ì´ë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : Hermesê°€ ì²˜ìŒ ë‚˜ì™”ì„ ë•ŒëŠ” ê¸°ëŠ¥ì´ ì œí•œì ì´ì—ˆì§€ë§Œ, ì´ì œëŠ” ì ì  ë” ê°•ë ¥í•´ì§€ê³  ìžˆë‹µë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ê¸°ë‹¤ë ¤ ë´…ì‹œë‹¤!)
> 

### ì»¤ë®¤ë‹ˆí‹° ì£¼ë„ í•´ê²°ì±…

React Native ì»¤ë®¤ë‹ˆí‹°ì—ì„œë„ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ë„êµ¬ì™€ ë°©ë²•ì„ ê°œë°œí•˜ê³  ìžˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `react-native-esbuild`ì™€ ê°™ì€ í”„ë¡œì íŠ¸ëŠ” Metro ëŒ€ì‹  esbuildë¥¼ ì‚¬ìš©í•˜ì—¬ ë” ë‚˜ì€ ESM ì§€ì›ì„ ì œê³µí•˜ë ¤ëŠ” ì‹œë„ì´ë‹¤.

> (ðŸ‘¨ðŸ»â€ðŸ« : í˜„ìž¬ëŠ” í† ìŠ¤ ê°œë°œìž ì´ì‹  ê±° ê°™ì€ë° í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ë“¤ì—¬ë‹¤ë³´ì‹œë©´, ì§„ì§œ ëŒ€ë‹¨í•œ ë…¸ë ¥ì´ ë“¤ì–´ê°„ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤â€¦.! ë˜ë ¤, ì´ ë¶„ì€ í† ìŠ¤ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì˜ ì„±ê³µ ì‚¬ë¡€ë¥¼ ë³´ê³ ì„œ, ê³¼ê°í•˜ê²Œ ì‹œë„í•´ë³´ì•˜ë‹¤ê³  í•˜ë„¤ìš”. )
> 

ì¶œì²˜: [react-native-esbuild](https://github.com/leegeunhyeok/react-native-esbuild)

## ê²°ë¡  ë° ì‹¤ìš©ì ì¸ ì¡°ì–¸

React Nativeì˜ CommonJS ì˜ì¡´ì„±ì€ í˜„ëŒ€ ìžë°”ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœê³„ì™€ì˜ í†µí•©ì„ ì–´ë µê²Œ ë§Œë“œëŠ” ìš”ì†Œ ì¤‘ í•˜ë‚˜ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ì œí•œ ì†ì—ì„œë„ íš¨ê³¼ì ìœ¼ë¡œ ê°œë°œí•˜ê¸° ìœ„í•œ ë°©ë²•ë“¤ì´ ì¡´ìž¬í•œë‹¤.

1. **RNìœ¼ë¡œ ê°œë°œ ì¤‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ ì‹œ CommonJS í˜¸í™˜ì„± í™•ì¸**: ìƒˆë¡œìš´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë„ìž…í•  ë•Œ CommonJS ì§€ì› ì—¬ë¶€ë¥¼ ë¯¸ë¦¬ í™•ì¸í•˜ìž.
2. **ë³€í™˜ ë„êµ¬ í™œìš©**: ESM ì „ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•  ê²½ìš°, Babel í”ŒëŸ¬ê·¸ì¸ì´ë‚˜ ê¸°íƒ€ ë³€í™˜ ë„êµ¬ë¥¼ í™œìš©í•˜ìž.
3. **Metro ì„¤ì • ìµœì í™”**: í”„ë¡œì íŠ¸ì˜ ìš”êµ¬ì‚¬í•­ì— ë§žê²Œ Metro ì„¤ì •ì„ ìµœì í™”í•˜ì—¬ í˜¸í™˜ì„± ë¬¸ì œë¥¼ ìµœì†Œí™”í•˜ìž.
4. **ì»¤ë®¤ë‹ˆí‹° ë™í–¥ ì£¼ì‹œ**: React Native ì»¤ë®¤ë‹ˆí‹°ì™€ ê³µì‹ íŒ€ì˜ ë°œí‘œë¥¼ ì£¼ì‹œí•˜ì—¬ ESM ì§€ì› ê°œì„ ì— ê´€í•œ ì†Œì‹ì„ ë†“ì¹˜ì§€ ë§ìž.

React Nativeì˜ CommonJS ì˜ì¡´ì„±ì€ ë‹¨ê¸°ê°„ì— í•´ê²°ë˜ê¸° ì–´ë ¤ìš´ ë¬¸ì œì´ì§€ë§Œ, ê°œë°œìžë¡œì„œ ì´ëŸ¬í•œ ì œí•œì„ ì´í•´í•˜ê³  ì ì ˆížˆ ëŒ€ì‘í•œë‹¤ë©´ ì—¬ì „ížˆ ìƒì‚°ì ì¸ ê°œë°œì´ ê°€ëŠ¥í•˜ë‹¤. ëª¨ë°”ì¼ ì•± ê°œë°œì˜ ì—¬ì •ì—ì„œ ì´ëŸ¬í•œ ë„ì „ì€ ìš°ë¦¬ë¥¼ ë” ë‚˜ì€ ê°œë°œìžë¡œ ì„±ìž¥ì‹œí‚¤ëŠ” ê¸°íšŒê°€ ë  ìˆ˜ ìžˆë‹¤. ðŸ’ª

> ðŸ™‡ðŸ» ê¸€ ë‚´ì— í‹€ë¦° ì , ì˜¤íƒˆìž, ë¹„íŒ, ê³µê° ë“± ëª¨ë‘ ì ì–´ì£¼ì…”ë„ ë©ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤..! ðŸ™‡ðŸ»
>
